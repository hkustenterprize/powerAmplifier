ARM GAS  C:\Users\acw\AppData\Local\Temp\cckmubSq.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"sampling.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.SamplingStart,"ax",%progbits
  18              		.align	1
  19              		.global	SamplingStart
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  23              		.fpu fpv4-sp-d16
  25              	SamplingStart:
  26              	.LFB126:
  27              		.file 1 "Src/sampling.c"
   1:Src/sampling.c **** #include "main.h"
   2:Src/sampling.c **** #include "can.h"
   3:Src/sampling.c **** #include "dac.h"
   4:Src/sampling.c **** #include "dma.h"
   5:Src/sampling.c **** #include "sdadc.h"
   6:Src/sampling.c **** #include "gpio.h"
   7:Src/sampling.c **** #include "sampling.h"
   8:Src/sampling.c **** #include "stm32f3xx_hal.h"
   9:Src/sampling.c **** 
  10:Src/sampling.c **** uint16_t dacValue = 1125;
  11:Src/sampling.c **** uint32_t currentSamples[CURRENT_SAMPLE_AMOUNT];
  12:Src/sampling.c **** int32_t currentSum = 0;
  13:Src/sampling.c **** float currentAvg = 0;
  14:Src/sampling.c **** 
  15:Src/sampling.c **** void SamplingStart(void)
  16:Src/sampling.c **** {
  28              		.loc 1 16 0
  29              		.cfi_startproc
  30              		@ Volatile: function does not return.
  31              		@ args = 0, pretend = 0, frame = 0
  32              		@ frame_needed = 0, uses_anonymous_args = 0
  33 0000 08B5     		push	{r3, lr}
  34              	.LCFI0:
  35              		.cfi_def_cfa_offset 8
  36              		.cfi_offset 3, -8
  37              		.cfi_offset 14, -4
  17:Src/sampling.c ****     HAL_DAC_Start(&hdac1, DAC_CHANNEL_1);
  38              		.loc 1 17 0
  39 0002 0E4C     		ldr	r4, .L4
  40 0004 0021     		movs	r1, #0
  41 0006 2046     		mov	r0, r4
ARM GAS  C:\Users\acw\AppData\Local\Temp\cckmubSq.s 			page 2


  42 0008 FFF7FEFF 		bl	HAL_DAC_Start
  43              	.LVL0:
  18:Src/sampling.c ****     HAL_DAC_SetValue(&hdac1, DAC_CHANNEL_1, DAC_ALIGN_12B_R, (uint32_t)dacValue);
  44              		.loc 1 18 0
  45 000c 0C4B     		ldr	r3, .L4+4
  46 000e 1B88     		ldrh	r3, [r3]
  47 0010 0022     		movs	r2, #0
  48 0012 1146     		mov	r1, r2
  49 0014 2046     		mov	r0, r4
  50 0016 FFF7FEFF 		bl	HAL_DAC_SetValue
  51              	.LVL1:
  19:Src/sampling.c ****     HAL_SDADC_CalibrationStart(&hsdadc3, SDADC_CALIBRATION_SEQ_1);
  52              		.loc 1 19 0
  53 001a 0A4C     		ldr	r4, .L4+8
  54 001c 0021     		movs	r1, #0
  55 001e 2046     		mov	r0, r4
  56 0020 FFF7FEFF 		bl	HAL_SDADC_CalibrationStart
  57              	.LVL2:
  20:Src/sampling.c ****     HAL_SDADC_PollForCalibEvent(&hsdadc3, HAL_MAX_DELAY);
  58              		.loc 1 20 0
  59 0024 4FF0FF31 		mov	r1, #-1
  60 0028 2046     		mov	r0, r4
  61 002a FFF7FEFF 		bl	HAL_SDADC_PollForCalibEvent
  62              	.LVL3:
  21:Src/sampling.c ****     HAL_SDADC_Start_DMA(&hsdadc3, currentSamples, CURRENT_SAMPLE_AMOUNT);
  63              		.loc 1 21 0
  64 002e 3222     		movs	r2, #50
  65 0030 0549     		ldr	r1, .L4+12
  66 0032 2046     		mov	r0, r4
  67 0034 FFF7FEFF 		bl	HAL_SDADC_Start_DMA
  68              	.LVL4:
  69              	.L2:
  70 0038 FEE7     		b	.L2
  71              	.L5:
  72 003a 00BF     		.align	2
  73              	.L4:
  74 003c 00000000 		.word	hdac1
  75 0040 00000000 		.word	.LANCHOR0
  76 0044 00000000 		.word	hsdadc3
  77 0048 00000000 		.word	currentSamples
  78              		.cfi_endproc
  79              	.LFE126:
  81              		.global	__aeabi_i2d
  82              		.global	__aeabi_ddiv
  83              		.global	__aeabi_dadd
  84              		.global	__aeabi_d2f
  85              		.section	.text.HAL_SDADC_ConvCpltCallback,"ax",%progbits
  86              		.align	1
  87              		.global	HAL_SDADC_ConvCpltCallback
  88              		.syntax unified
  89              		.thumb
  90              		.thumb_func
  91              		.fpu fpv4-sp-d16
  93              	HAL_SDADC_ConvCpltCallback:
  94              	.LFB127:
  22:Src/sampling.c ****     while (1)
  23:Src/sampling.c ****     {
ARM GAS  C:\Users\acw\AppData\Local\Temp\cckmubSq.s 			page 3


  24:Src/sampling.c ****     }
  25:Src/sampling.c **** }
  26:Src/sampling.c **** 
  27:Src/sampling.c **** void HAL_SDADC_ConvCpltCallback(SDADC_HandleTypeDef *hsdadc)
  28:Src/sampling.c **** {
  95              		.loc 1 28 0
  96              		.cfi_startproc
  97              		@ args = 0, pretend = 0, frame = 0
  98              		@ frame_needed = 0, uses_anonymous_args = 0
  99              	.LVL5:
 100 0000 08B5     		push	{r3, lr}
 101              	.LCFI1:
 102              		.cfi_def_cfa_offset 8
 103              		.cfi_offset 3, -8
 104              		.cfi_offset 14, -4
  29:Src/sampling.c ****     if (hsdadc == &hsdadc3)
 105              		.loc 1 29 0
 106 0002 174B     		ldr	r3, .L12+8
 107 0004 8342     		cmp	r3, r0
 108 0006 00D0     		beq	.L11
 109              	.LVL6:
 110              	.L6:
  30:Src/sampling.c ****     { //current
  31:Src/sampling.c ****         currentSum = 0;
  32:Src/sampling.c ****         for (uint8_t i = 0; i < CURRENT_SAMPLE_AMOUNT; i++)
  33:Src/sampling.c ****         {
  34:Src/sampling.c ****             currentSum += (int16_t)(currentSamples[i] & 0xFFFF);
  35:Src/sampling.c ****         }
  36:Src/sampling.c ****         currentAvg = (-currentSum * 1.0 / CURRENT_SAMPLE_AMOUNT + 25.0) / 3885.5;
  37:Src/sampling.c ****     }
  38:Src/sampling.c **** }
 111              		.loc 1 38 0
 112 0008 08BD     		pop	{r3, pc}
 113              	.LVL7:
 114              	.L11:
  31:Src/sampling.c ****         for (uint8_t i = 0; i < CURRENT_SAMPLE_AMOUNT; i++)
 115              		.loc 1 31 0
 116 000a 0023     		movs	r3, #0
 117 000c 154A     		ldr	r2, .L12+12
 118 000e 1360     		str	r3, [r2]
 119              	.LVL8:
 120              	.LBB2:
  32:Src/sampling.c ****         {
 121              		.loc 1 32 0
 122 0010 08E0     		b	.L8
 123              	.LVL9:
 124              	.L9:
  34:Src/sampling.c ****         }
 125              		.loc 1 34 0 discriminator 3
 126 0012 154A     		ldr	r2, .L12+16
 127 0014 32F92300 		ldrsh	r0, [r2, r3, lsl #2]
 128 0018 1249     		ldr	r1, .L12+12
 129 001a 0A68     		ldr	r2, [r1]
 130 001c 0244     		add	r2, r2, r0
 131 001e 0A60     		str	r2, [r1]
  32:Src/sampling.c ****         {
 132              		.loc 1 32 0 discriminator 3
ARM GAS  C:\Users\acw\AppData\Local\Temp\cckmubSq.s 			page 4


 133 0020 0133     		adds	r3, r3, #1
 134              	.LVL10:
 135 0022 DBB2     		uxtb	r3, r3
 136              	.LVL11:
 137              	.L8:
  32:Src/sampling.c ****         {
 138              		.loc 1 32 0 is_stmt 0 discriminator 1
 139 0024 312B     		cmp	r3, #49
 140 0026 F4D9     		bls	.L9
 141              	.LBE2:
  36:Src/sampling.c ****     }
 142              		.loc 1 36 0 is_stmt 1
 143 0028 0E4B     		ldr	r3, .L12+12
 144              	.LVL12:
 145 002a 1868     		ldr	r0, [r3]
 146 002c 4042     		negs	r0, r0
 147 002e FFF7FEFF 		bl	__aeabi_i2d
 148              	.LVL13:
 149 0032 0022     		movs	r2, #0
 150 0034 0D4B     		ldr	r3, .L12+20
 151 0036 FFF7FEFF 		bl	__aeabi_ddiv
 152              	.LVL14:
 153 003a 0022     		movs	r2, #0
 154 003c 0C4B     		ldr	r3, .L12+24
 155 003e FFF7FEFF 		bl	__aeabi_dadd
 156              	.LVL15:
 157 0042 05A3     		adr	r3, .L12
 158 0044 D3E90023 		ldrd	r2, [r3]
 159 0048 FFF7FEFF 		bl	__aeabi_ddiv
 160              	.LVL16:
 161 004c FFF7FEFF 		bl	__aeabi_d2f
 162              	.LVL17:
 163 0050 084B     		ldr	r3, .L12+28
 164 0052 1860     		str	r0, [r3]	@ float
 165              		.loc 1 38 0
 166 0054 D8E7     		b	.L6
 167              	.L13:
 168 0056 00BF     		.align	3
 169              	.L12:
 170 0058 00000000 		.word	0
 171 005c 005BAE40 		.word	1085168384
 172 0060 00000000 		.word	hsdadc3
 173 0064 00000000 		.word	.LANCHOR1
 174 0068 00000000 		.word	currentSamples
 175 006c 00004940 		.word	1078525952
 176 0070 00003940 		.word	1077477376
 177 0074 00000000 		.word	.LANCHOR2
 178              		.cfi_endproc
 179              	.LFE127:
 181              		.global	currentAvg
 182              		.global	currentSum
 183              		.comm	currentSamples,200,4
 184              		.global	dacValue
 185              		.section	.bss.currentAvg,"aw",%nobits
 186              		.align	2
 187              		.set	.LANCHOR2,. + 0
 190              	currentAvg:
ARM GAS  C:\Users\acw\AppData\Local\Temp\cckmubSq.s 			page 5


 191 0000 00000000 		.space	4
 192              		.section	.bss.currentSum,"aw",%nobits
 193              		.align	2
 194              		.set	.LANCHOR1,. + 0
 197              	currentSum:
 198 0000 00000000 		.space	4
 199              		.section	.data.dacValue,"aw",%progbits
 200              		.align	1
 201              		.set	.LANCHOR0,. + 0
 204              	dacValue:
 205 0000 6504     		.short	1125
 206              		.text
 207              	.Letext0:
 208              		.file 2 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\include
 209              		.file 3 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\include
 210              		.file 4 "Drivers/CMSIS/Include/core_cm4.h"
 211              		.file 5 "Drivers/CMSIS/Device/ST/STM32F3xx/Include/system_stm32f3xx.h"
 212              		.file 6 "Drivers/CMSIS/Device/ST/STM32F3xx/Include/stm32f373xc.h"
 213              		.file 7 "Drivers/CMSIS/Device/ST/STM32F3xx/Include/stm32f3xx.h"
 214              		.file 8 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\include
 215              		.file 9 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\include
 216              		.file 10 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\lib\\gcc\\arm-none-ea
 217              		.file 11 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\includ
 218              		.file 12 "Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_def.h"
 219              		.file 13 "Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_dma.h"
 220              		.file 14 "Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_can.h"
 221              		.file 15 "Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_dac.h"
 222              		.file 16 "Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_sdadc.h"
 223              		.file 17 "Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal.h"
 224              		.file 18 "Inc/can.h"
 225              		.file 19 "Inc/dac.h"
 226              		.file 20 "Inc/sdadc.h"
 227              		.file 21 "Inc/sampling.h"
ARM GAS  C:\Users\acw\AppData\Local\Temp\cckmubSq.s 			page 6


DEFINED SYMBOLS
                            *ABS*:00000000 sampling.c
C:\Users\acw\AppData\Local\Temp\cckmubSq.s:18     .text.SamplingStart:00000000 $t
C:\Users\acw\AppData\Local\Temp\cckmubSq.s:25     .text.SamplingStart:00000000 SamplingStart
C:\Users\acw\AppData\Local\Temp\cckmubSq.s:74     .text.SamplingStart:0000003c $d
                            *COM*:000000c8 currentSamples
C:\Users\acw\AppData\Local\Temp\cckmubSq.s:86     .text.HAL_SDADC_ConvCpltCallback:00000000 $t
C:\Users\acw\AppData\Local\Temp\cckmubSq.s:93     .text.HAL_SDADC_ConvCpltCallback:00000000 HAL_SDADC_ConvCpltCallback
C:\Users\acw\AppData\Local\Temp\cckmubSq.s:170    .text.HAL_SDADC_ConvCpltCallback:00000058 $d
C:\Users\acw\AppData\Local\Temp\cckmubSq.s:190    .bss.currentAvg:00000000 currentAvg
C:\Users\acw\AppData\Local\Temp\cckmubSq.s:197    .bss.currentSum:00000000 currentSum
C:\Users\acw\AppData\Local\Temp\cckmubSq.s:204    .data.dacValue:00000000 dacValue
C:\Users\acw\AppData\Local\Temp\cckmubSq.s:186    .bss.currentAvg:00000000 $d
C:\Users\acw\AppData\Local\Temp\cckmubSq.s:193    .bss.currentSum:00000000 $d
C:\Users\acw\AppData\Local\Temp\cckmubSq.s:200    .data.dacValue:00000000 $d

UNDEFINED SYMBOLS
HAL_DAC_Start
HAL_DAC_SetValue
HAL_SDADC_CalibrationStart
HAL_SDADC_PollForCalibEvent
HAL_SDADC_Start_DMA
hdac1
hsdadc3
__aeabi_i2d
__aeabi_ddiv
__aeabi_dadd
__aeabi_d2f
